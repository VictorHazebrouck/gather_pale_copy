<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>game/main.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Background.html">Background</a></li><li><a href="Game.html">Game</a></li><li><a href="Player.html">Player</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Player.html#getScreenPosition">getScreenPosition</a></li><li data-type='method' style='display: none;'><a href="Player.html#hasCollided">hasCollided</a></li><li data-type='method' style='display: none;'><a href="Player.html#movePlayer">movePlayer</a></li></ul></li><li><a href="PlayerOther.html">PlayerOther</a><ul class='methods'><li data-type='method' style='display: none;'><a href="PlayerOther.html#createPlayer">createPlayer</a></li></ul></li><li><a href="PlayerSelf.html">PlayerSelf</a><ul class='methods'><li data-type='method' style='display: none;'><a href="PlayerSelf.html#createPlayer">createPlayer</a></li><li data-type='method' style='display: none;'><a href="PlayerSelf.html#registerMovementInput">registerMovementInput</a></li></ul></li><li><a href="Socket.html">Socket</a></li><li><a href="db.html">db</a></li></ul><h3>Global</h3><ul><li><a href="global.html#ANameHasChangedEventData">ANameHasChangedEventData</a></li><li><a href="global.html#ChatMessageReceivedEventData">ChatMessageReceivedEventData</a></li><li><a href="global.html#ChatStore">ChatStore</a></li><li><a href="global.html#ConnectionDataEventData">ConnectionDataEventData</a></li><li><a href="global.html#Coordinates">Coordinates</a></li><li><a href="global.html#Direction">Direction</a></li><li><a href="global.html#EventBus">EventBus</a></li><li><a href="global.html#Message">Message</a></li><li><a href="global.html#MoveEventData">MoveEventData</a></li><li><a href="global.html#MoveInstructions">MoveInstructions</a></li><li><a href="global.html#NameChangedEventData">NameChangedEventData</a></li><li><a href="global.html#NewPlayerConnectedEventData">NewPlayerConnectedEventData</a></li><li><a href="global.html#NewPlayerMoveEventData">NewPlayerMoveEventData</a></li><li><a href="global.html#ParticipantsStore">ParticipantsStore</a></li><li><a href="global.html#PlayerCardStore">PlayerCardStore</a></li><li><a href="global.html#PlayerClickEventData">PlayerClickEventData</a></li><li><a href="global.html#PlayerData">PlayerData</a></li><li><a href="global.html#PlayerDataWithCoordinates">PlayerDataWithCoordinates</a></li><li><a href="global.html#PlayerDisconnectdEventData">PlayerDisconnectdEventData</a></li><li><a href="global.html#Room">Room</a></li><li><a href="global.html#SendChatMessageEventData">SendChatMessageEventData</a></li><li><a href="global.html#User">User</a></li><li><a href="global.html#UserStore">UserStore</a></li><li><a href="global.html#UtilsStore">UtilsStore</a></li><li><a href="global.html#disconnectUser">disconnectUser</a></li><li><a href="global.html#filterPlayerOthers">filterPlayerOthers</a></li><li><a href="global.html#filterPlayers">filterPlayers</a></li><li><a href="global.html#formatNow">formatNow</a></li><li><a href="global.html#getRoomsDb">getRoomsDb</a></li><li><a href="global.html#initGame">initGame</a></li><li><a href="global.html#newChatDb">newChatDb</a></li><li><a href="global.html#newRoomDb">newRoomDb</a></li><li><a href="global.html#newUserDB">newUserDB</a></li><li><a href="global.html#userIdReceiver">userIdReceiver</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">game/main.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { Application, Ticker } from "pixi.js";
import Background from "./layers/background/Background";
import EventBus from "../EventBus";
import Game from "./game/Game";
import PlayerSelf from "./player/PlayerSelf";
import PlayerOther from "./player/PlayerOther";

/**
 * Initialization function
 *
 * @param {UserStore} playerSelfData 
 * @returns {Promise&lt;void>}
 */
async function initGame(playerSelfData) {
    // get the dom element in which to place the game
    const gamecontainer = document.getElementById("container-game");
    if (!gamecontainer) {
        throw new Error("COULDN'T FIND GAME CONTAINER");
    }

    //init the Application instance
    const app = new Application();
    await app.init({ resizeTo: gamecontainer });
    gamecontainer.appendChild(app.canvas);
    Ticker.shared.autoStart = true;

    //init game instance
    const game = new Game(app);
    app.stage.addChild(game);

    //init background
    const background = new Background();
    await background.generateBackground();
    game.addChild(background);

    //init self player and attach the camera to it
    const player = await PlayerSelf.createPlayer(playerSelfData);
    player.registerMovementInput();
    //player.registerMovementInput("KeyW","KeyS","KeyA","KeyD")

    game.addChild(player);
    game.attachCameraToObject(player);

    //handle first connection, get current game state from server
    EventBus.subscribe("connectionData", async (data) => {
        for (let i = 0; i &lt; data.Players.length; i++) {
            const player = await PlayerOther.createPlayer(data.Players[i], game.children);

            player &amp;&amp; game.addChild(player);
        }
    });

    //handle new players connection, get new player's data
    EventBus.subscribe("newPlayerConnected", async (newPlayerData) => {
        const player = await PlayerOther.createPlayer(newPlayerData, game.children);
        player &amp;&amp; game.addChild(player);
    });
}

export default initGame
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.3</a> on Wed Jul 10 2024 15:21:09 GMT+0200 (Central European Summer Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
